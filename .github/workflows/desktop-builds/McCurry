# â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
# â”ƒ ğŸ–¥ï¸ Workflow - Desktop Builds                â”‚
# â”ƒ ğŸ’» Linux, Windows, macOS (skip por enquanto) â”‚
# â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

name: "ğŸ–¥ï¸ Desktop Builds"

on:
  workflow_call:
  workflow_dispatch:
    inputs:
      skip_builds:
        description: 'Pular builds desktop?'
        required: false
        default: true
        type: boolean
      platforms:
        description: 'Plataformas (linux,windows,macos)'
        required: false
        default: 'linux,windows,macos'
        type: string

jobs:
  # â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  # â”‚ ğŸ§ Linux Build                               â”‚
  # â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
  linux-build:
    name: "ğŸ§ Linux Build"
    runs-on: ubuntu-latest
    if: ${{ github.event.inputs.skip_builds != 'true' && contains(github.event.inputs.platforms, 'linux') }}
    
    steps:
      - name: "ğŸ“¥ Checkout cÃ³digo"
        uses: actions/checkout@v4

      - name: "ğŸ› ï¸ Instalar Flutter"
        uses: subosito/flutter-action@v2
        with:
          flutter-version: '3.24.5'
          cache: true

      - name: "ğŸ“¦ Instalar dependÃªncias Linux"
        run: |
          sudo apt-get update -y
          sudo apt-get install -y ninja-build libgtk-3-dev

      - name: "ğŸ“¦ Flutter dependencies"
        run: flutter pub get

      - name: "ğŸ—ï¸ Build Linux"
        run: flutter build linux --release

      - name: "ğŸ“¤ Upload Linux Build"
        uses: actions/upload-artifact@v4
        with:
          name: "observador-linux"
          path: build/linux/x64/release/bundle/
          retention-days: 30

  # â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  # â”‚ ğŸªŸ Windows Build                             â”‚
  # â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
  windows-build:
    name: "ğŸªŸ Windows Build"
    runs-on: windows-latest
    if: ${{ github.event.inputs.skip_builds != 'true' && contains(github.event.inputs.platforms, 'windows') }}
    
    steps:
      - name: "ğŸ“¥ Checkout cÃ³digo"
        uses: actions/checkout@v4

      - name: "ğŸ› ï¸ Instalar Flutter"
        uses: subosito/flutter-action@v2
        with:
          flutter-version: '3.24.5'
          cache: true

      - name: "ğŸ“¦ Flutter dependencies"
        run: flutter pub get

      - name: "ğŸ—ï¸ Build Windows"
        run: flutter build windows --release

      - name: "ğŸ“¤ Upload Windows Build"
        uses: actions/upload-artifact@v4
        with:
          name: "observador-windows"
          path: build/windows/x64/runner/Release/
          retention-days: 30

  # â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  # â”‚ ğŸ macOS Build                               â”‚
  # â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
  macos-build:
    name: "ğŸ macOS Build"
    runs-on: macos-latest
    if: ${{ github.event.inputs.skip_builds != 'true' && contains(github.event.inputs.platforms, 'macos') }}
    
    steps:
      - name: "ğŸ“¥ Checkout cÃ³digo"
        uses: actions/checkout@v4

      - name: "ğŸ› ï¸ Instalar Flutter"
        uses: subosito/flutter-action@v2
        with:
          flutter-version: '3.24.5'
          cache: true

      - name: "ğŸ“¦ Flutter dependencies"
        run: flutter pub get

      - name: "ğŸ—ï¸ Build macOS"
        run: flutter build macos --release

      - name: "ğŸ“¤ Upload macOS Build"
        uses: actions/upload-artifact@v4
        with:
          name: "observador-macos"
          path: build/macos/Build/Products/Release/
          retention-days: 30

  # â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
  # â”‚ â­ï¸ Desktop Builds Skipped                   â”‚
  # â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
  desktop-skip:
    name: "ğŸ–¥ï¸ Desktop Builds (Skipped)"
    runs-on: ubuntu-latest
    if: ${{ github.event.inputs.skip_builds == 'true' || github.event.inputs.skip_builds == null }}
    
    steps:
      - name: "â­ï¸ Skip Desktop Builds"
        run: |
          echo "ğŸ–¥ï¸ Builds desktop foram pulados"
          echo ""
          echo "ğŸ’¡ Para habilitar builds desktop:"
          echo "   ğŸ§ Linux: Instalar dependÃªncias GTK"
          echo "   ğŸªŸ Windows: Configurar Visual Studio"
          echo "   ğŸ macOS: Configurar Xcode"
          echo ""
          echo "âœ… Configure e mude 'skip_builds' para false"
          echo "ğŸ¯ Especifique plataformas em 'platforms'"
          echo ""
          echo "ğŸ“ Exemplo de uso:"
          echo "   platforms: 'linux,windows'"
          echo "   skip_builds: false"
